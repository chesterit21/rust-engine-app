## DEPLOYMENT

**Worker code SUDAH handle:**

- âœ… Start llama-server otomatis
- âœ… Stop llama-server setelah batch selesai
- âœ… Restart kalau perlu

***

## ðŸŽ¯ JADI CUMA INSTALL 1 SERVICE AJA

### INSTALL EMBEDDING WORKER SERVICE ONLY

```powershell
# Jalankan sebagai Administrator
cd C:\Tools\nssm-2.24\win64

# Install service
.\nssm.exe install "RAG-Embedding-Worker" "C:\Program Files\RAG-System\embedding-worker\rag-embedding-worker.exe"

# Set working directory
.\nssm.exe set "RAG-Embedding-Worker" AppDirectory "C:\Program Files\RAG-System\embedding-worker"

# Display name & description
.\nssm.exe set "RAG-Embedding-Worker" DisplayName "RAG Embedding Worker"
.\nssm.exe set "RAG-Embedding-Worker" Description "Worker service for processing documents and generating embeddings (auto-manages llama-server)"

# Auto start on boot
.\nssm.exe set "RAG-Embedding-Worker" Start SERVICE_AUTO_START

# Environment variables
.\nssm.exe set "RAG-Embedding-Worker" AppEnvironmentExtra "RUST_LOG=info"

# Logging
.\nssm.exe set "RAG-Embedding-Worker" AppStdout "C:\Program Files\RAG-System\logs\embedding-worker-stdout.log"
.\nssm.exe set "RAG-Embedding-Worker" AppStderr "C:\Program Files\RAG-System\logs\embedding-worker-stderr.log"

# Auto restart on failure
.\nssm.exe set "RAG-Embedding-Worker" AppExit Default Restart
.\nssm.exe set "RAG-Embedding-Worker" AppRestartDelay 5000

# Start service
.\nssm.exe start "RAG-Embedding-Worker"
```

***

## âœ… VERIFY

```powershell
# Check service
Get-Service "RAG-Embedding-Worker"

# Check logs
Get-Content "C:\Program Files\RAG-System\logs\embedding-worker-stdout.log" -Tail 50 -Wait

# Harusnya muncul:
# âœ… Worker started
# ðŸš€ Starting llama-server...
# âœ… Llama-server ready
```

***

## ðŸ’¡ KENAPA GAK PERLU LLAMA-SERVER SERVICE TERPISAH?

**Worker design:**

- Start llama-server **on-demand** (per batch)
- Stop llama-server **after batch** (hemat memory)
- Auto-restart kalau crash

**Keuntungan:**

- âœ… Memory efficient (llama-server cuma running waktu ada job)
- âœ… Lebih simple (cuma 1 service)
- âœ… Worker control lifecycle llama-server penuh

***

## ðŸŽ‰ DONE

**Cuma perlu 1 service: RAG-Embedding-Worker**

Worker akan manage llama-server sendiri! ðŸš€

Sorry bro untuk confusion tadi! ðŸ˜…
